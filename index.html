<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>HabitCraft AI — Телеграм Mini App</title>

  <!-- Telegram Web App (необязательно) -->
  <script async src="https://telegram.org/js/telegram-web-app.js"></script>

  <!-- Стили -->
  <link rel="stylesheet" href="styles.css">

  <!-- Поддержка кастомного API-ключа в window.APP_CONFIG
       Если хотите, задайте в Vercel переменную и вставьте здесь при билде.
       Пример (локально): <script>window.APP_CONFIG = { OPENROUTER_API_KEY: 'sk-...' }</script>
  -->
  <script>
    // Если окружение не установлено, оставим пустой объект — AI уйдёт в mock-режим.
    window.APP_CONFIG = window.APP_CONFIG || { OPENROUTER_API_KEY: null };
  </script>
</head>
<body>
  <div id="root" class="app-root"></div>

  <!-- Подключаем конфиг и модули (ESM). Порядок важен. -->
  <script type="module">
    // Загружаем конфиг и приложение
    import './config.js';
    import App from './app.client.js';

    // Инициализация приложения
    document.addEventListener('DOMContentLoaded', () => {
      const mount = document.getElementById('root');
      const app = new App({ mount });
      app.init();
      // Экспорт в window для отладки
      window.habitCraft = app;
    });
  </script>
</body>
</html>